<!DOCTYPE html><!-- Last Published: Sat Aug 05 2023 08:02:23 GMT+0000 (Coordinated Universal Time) --><html data-wf-domain="webflow.internal.0x.org" data-wf-page="641b3189a96819a534929e74" data-wf-site="640bf70a17d12b42d97a052b"><head><meta charset="utf-8"/><title>Scaling DeFi — Layer One</title><meta content="A visual tour of Ethereum’s scaling challenge." name="description"/><meta content="Scaling DeFi — Layer One" property="og:title"/><meta content="A visual tour of Ethereum’s scaling challenge." property="og:description"/><meta content="https://assets.website-files.com/641b3189771d28b3a1d81347/643f1e0c42eb6132fb7243fa_154.png" property="og:image"/><meta content="Scaling DeFi — Layer One" property="twitter:title"/><meta content="A visual tour of Ethereum’s scaling challenge." property="twitter:description"/><meta content="https://assets.website-files.com/641b3189771d28b3a1d81347/643f1e0c42eb6132fb7243fa_154.png" property="twitter:image"/><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://assets.website-files.com/640bf70a17d12b42d97a052b/css/0xwebsite.ee9796a5e.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com" rel="preconnect"/><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous"/><script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script><script type="text/javascript">WebFont.load({  google: {    families: ["Inconsolata:400,700","Roboto Mono:regular"]  }});</script><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="https://assets.website-files.com/640bf70a17d12b42d97a052b/643687695eb8226b59e064ee_favicon32.png" rel="shortcut icon" type="image/x-icon"/><link href="https://assets.website-files.com/640bf70a17d12b42d97a052b/643684705f25ee831d18191a_favicon256.png" rel="apple-touch-icon"/><style type="text/css">
  body {
    -webkit-font-smoothing: antialiased;
    font-variant-numeric: slashed-zero;
  }
  * {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
    font-variant-numeric: slashed-zero;
}
  
.tippy-box[data-theme~="zeroex"] {
  background-color: white;
  padding: 12px 16px 12px 12px;
  border-radius: 8px;
  border: 1px solid var(--gray-200, #E4E4E7);
  background: var(--base-white, #FFF);
  box-shadow: 0px 3px 28px 0px rgba(24, 24, 27, 0.10);
  
  color: var(--gray-700, #3F3F46);
/* Desktop & Mobile/Body S */
  font-size: 14px;
  font-family: PolySans;
  font-style: normal;
  font-weight: 400;
  line-height: 120%;
}
</style>

<!-- Tooltips -->
<script src="https://unpkg.com/@popperjs/core@2" async></script>
<script id="tippy-loader" src="https://unpkg.com/tippy.js@6" async></script>

<!-- Amplitude -->
<script type="text/javascript">
  !(function () {
    "use strict";
    !(function (e, t) {
      var n = e.amplitude || { _q: [], _iq: {} };
      if (n.invoked) {
        // don't log
      } else {
        var r = function (e, t) {
            e.prototype[t] = function () {
              return (
                this._q.push({
                  name: t,
                  args: Array.prototype.slice.call(arguments, 0),
                }),
                this
              );
            };
          },
          s = function (e, t, n) {
            return function (r) {
              e._q.push({
                name: t,
                args: Array.prototype.slice.call(n, 0),
                resolve: r,
              });
            };
          },
          o = function (e, t, n) {
            e[t] = function () {
              if (n)
                return {
                  promise: new Promise(
                    s(e, t, Array.prototype.slice.call(arguments))
                  ),
                };
            };
          },
          i = function (e) {
            for (var t = 0; t < y.length; t++) o(e, y[t], !1);
            for (var n = 0; n < g.length; n++) o(e, g[n], !0);
          };
        n.invoked = !0;
        var a = t.createElement("script");
        (a.type = "text/javascript"),
          (a.integrity =
            "sha384-TPZhteUkZj8CAyBx+GZZytBdkuKnhKsSKcCoVCq0QSteWf/Kw5Kb9oVFUROLE1l3"),
          (a.crossOrigin = "anonymous"),
          (a.async = !0),
          (a.src =
            "https://cdn.amplitude.com/libs/analytics-browser-1.9.1-min.js.gz"),
          (a.onload = function () {
            e.amplitude.runQueuedFunctions ||
              console.log("[Amplitude] Error: could not load SDK");
          });
        var c = t.getElementsByTagName("script")[0];
        c.parentNode.insertBefore(a, c);
        for (
          var u = function () {
              return (this._q = []), this;
            },
            l = [
              "add",
              "append",
              "clearAll",
              "prepend",
              "set",
              "setOnce",
              "unset",
              "preInsert",
              "postInsert",
              "remove",
              "getUserProperties",
            ],
            p = 0;
          p < l.length;
          p++
        )
          r(u, l[p]);
        n.Identify = u;
        for (
          var d = function () {
              return (this._q = []), this;
            },
            f = [
              "getEventProperties",
              "setProductId",
              "setQuantity",
              "setPrice",
              "setRevenue",
              "setRevenueType",
              "setEventProperties",
            ],
            v = 0;
          v < f.length;
          v++
        )
          r(d, f[v]);
        n.Revenue = d;
        var y = [
            "getDeviceId",
            "setDeviceId",
            "getSessionId",
            "setSessionId",
            "getUserId",
            "setUserId",
            "setOptOut",
            "setTransport",
            "reset",
          ],
          g = [
            "init",
            "add",
            "remove",
            "track",
            "logEvent",
            "identify",
            "groupIdentify",
            "setGroup",
            "revenue",
            "flush",
          ];
        i(n),
          (n.createInstance = function (e) {
            return (n._iq[e] = { _q: [] }), i(n._iq[e]), n._iq[e];
          }),
          (e.amplitude = n);
      }
    })(window, document);
  })();

  const isProduction = /https:\/\/(www\.)?0x\.org/gm.test(
    window.location.origin
  );

  const amplitudeKey = isProduction
    ? "2c14f0acafb192937da25e1f8136a841"
    : "7a6eb8646631c9274e0ee19bef2180fa";

  amplitude.init(amplitudeKey, /* opt_userId */ undefined, {
    defaultTracking: true,
    logLevel: isProduction ? "Error" : "Debug",
  });
</script>
<style>
h3, h4 {
	padding-top: 48px;
}

</style></head><body class="body"><nav class="navbar-container"><div data-w-id="98b43bc9-13ca-7d17-58df-d3b0b2b826ac" data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-lg w-nav"><div class="logo-container"><a href="../index.html" class="w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/640bfd7d8441821c4cd20210_logo.svg" loading="eager" alt="0x Logo wordmark, a bold &quot;zero&quot; and &quot;ex&quot;" class="_0x-logo"/></a></div><nav role="navigation" class="nav-menu-container w-nav-menu"><div class="nav-menu"><div data-hover="true" data-delay="100" class="dropdown w-dropdown"><div class="button-normal button-left button-hover no-cursor-pointer w-dropdown-toggle"><div class="nav-menu-lg-products-text">Products</div><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/640febc9acbad58858d72891_icon-arrow-down-800.svg" loading="lazy" width="10" alt="" class="products-arrow-down"/></div><nav class="menu-lg-product-dropdown-container dropdown-list-2 w-dropdown-list"><div class="menu-lg-products-dropdown"><a href="../products/swap" class="menu-lg-product-button menu-lg-product-button-top w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap.webp 1000w" alt="Swap API" class="menu-lg-product-button-image"/><div class="menu-lg-product-button-text"><div class="menu-lg-product-button-heading"><div class="menu-lg-product-button-product-text">Swap</div><div class="menu-md-product-button-api-text"> API</div></div><p class="body-s mb-0">Enable crypto trading</p></div></a><a href="../products/tx-relay" class="menu-lg-product-button w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay.webp 1000w" alt="Tx Relay API" class="menu-lg-product-button-image"/><div class="menu-lg-product-button-text"><div class="menu-lg-product-button-heading"><div class="menu-lg-product-button-product-text">Tx Relay</div><div class="menu-md-product-button-api-text"> API</div></div><p class="body-s mb-0">Build frictionless apps</p></div></a><a href="scaling-defi-layer-one#" class="menu-lg-product-button no-cursor inactive w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook.webp 1000w" alt="Ordebook API" class="menu-lg-product-button-image"/><div class="menu-lg-product-button-text"><div class="menu-lg-product-button-heading"><div class="menu-lg-product-button-product-text">Orderbook</div><div class="menu-md-product-button-api-text"> API</div></div><p class="body-s mb-0">Unlock limit orders</p></div></a><a href="scaling-defi-layer-one#" class="menu-lg-product-button no-cursor inactive w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history.webp 1000w" alt="Tx History API" class="menu-lg-product-button-image"/><div class="menu-lg-product-button-text"><div class="menu-lg-product-button-heading"><div class="menu-lg-product-button-product-text">Tx History</div><div class="menu-md-product-button-api-text"> API</div></div><p class="body-s mb-0">Show order history</p></div></a><a href="scaling-defi-layer-one#" class="menu-lg-product-button menu-lg-product-button-bottom no-cursor inactive w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry.webp 1000w" alt="Token Registry API" class="menu-lg-product-button-image"/><div class="menu-lg-product-button-text"><div class="menu-lg-product-button-heading"><div class="menu-lg-product-button-product-text">Token Registry</div><div class="menu-md-product-button-api-text"> API</div></div><p class="body-s mb-0">Curate tokens</p></div></a></div></nav></div><a href="../solutions" class="button-normal button-hover w-button">Solutions</a><link rel="prefetch" href="../solutions"/><a href="../pricing" class="button-normal button-hover w-button">Pricing</a><a href="http://0x.org/docs" target="_blank" class="button-normal button-hover w-inline-block"><div class="text-block-12 header-link">Docs</div><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/640febc93f4bfba547eaf378_icon-arrow-up-right-800.svg" loading="lazy" width="10" alt="" class="image-12"/></a><a href="../content-hub" class="button-normal button-right button-hover w-button">Content Hub</a></div></nav><div class="cta-container"><a href="../contact" class="button-normal button-left button-hover w-button">Contact us</a><a href="https://dashboard.0x.org/create-account" target="_blank" class="button-normal button-right button-accent w-button">Go to dashboard</a></div><div class="nav-menu-button w-nav-button"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/64122be5cf47f3d4543373fd_icon-line.svg" loading="lazy" width="16" alt="" class="nav-menu-botton-top-line"/><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/64122be5cf47f3d4543373fd_icon-line.svg" loading="lazy" width="16" alt="" class="nav-menu-button-bottom-line"/></div></div><div data-w-id="98b43bc9-13ca-7d17-58df-d3b0b2b826dd" class="navbar-md-sm"><div class="logo-container"><a href="../index.html" class="w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/640bfd7d8441821c4cd20210_logo.svg" loading="eager" alt="0x Logo wordmark, a bold &quot;zero&quot; and &quot;ex&quot;" class="_0x-logo"/></a></div><div data-w-id="98b43bc9-13ca-7d17-58df-d3b0b2b826e0" class="nav-menu-button"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/64122be5cf47f3d4543373fd_icon-line.svg" loading="lazy" width="16" alt="" class="nav-menu-botton-top-line"/><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/64122be5cf47f3d4543373fd_icon-line.svg" loading="lazy" width="16" alt="" class="nav-menu-button-bottom-line"/></div></div><div class="menu-md-sm"><div class="menu-sm"><div class="menu-sm-wrapper"><div class="menu-sm-products"><div data-hover="false" data-delay="0" data-w-id="98b43bc9-13ca-7d17-58df-d3b0b2b826e7" class="menu-product-button w-dropdown"><div class="menu-md-other-button w-dropdown-toggle"><div class="text-block-18">Products</div><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/640febc9acbad58858d72891_icon-arrow-down-800.svg" loading="lazy" alt="" class="products-arrow-down"/></div><nav class="dropdown-list w-dropdown-list"><div class="menu-sm-vertical-placeholder"></div><div class="menu-sm-scrolling-window"><div class="menu-sm-scrolling-products"><a href="../products/swap" class="menu-product--link w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap.webp 1000w" alt="Swap API" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><p class="body-m-median mb-0 text-gray-400"><span class="text-gray-800">Swap</span> API</p></div><p class="body-s mb-0">Enable crypto trading</p></div></a><a href="../products/tx-relay" class="menu-product--link w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay.webp 1000w" alt="Tx Relay API" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><p class="body-m-median mb-0 text-gray-400"><span class="text-gray-800">Tx Relay</span> API</p></div><p class="body-s mb-0">Build frictionless apps</p></div></a><a href="scaling-defi-layer-one#" class="menu-product--link bg-transparent w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook.webp 1000w" alt="Ordebook API" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><p class="body-m-median mb-0 text-gray-400"><span class="text-gray-800">Orderbook</span> API</p></div><p class="body-s mb-0">Unlock limit orders</p></div></a><a href="scaling-defi-layer-one#" class="menu-product--link bg-transparent w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history.webp 1000w" alt="Tx History API" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><p class="body-m-median mb-0 text-gray-400"><span class="text-gray-800">Tx History</span></p></div><p class="body-s mb-0">Show order history</p></div></a><a href="scaling-defi-layer-one#" class="menu-product--link bg-transparent w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry.webp 1000w" alt="Token Registry API" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><p class="body-m-median mb-0 text-gray-400"><span class="text-gray-800">Token Registry</span> API</p></div><p class="body-s mb-0">Curate tokens</p></div></a></div></div></nav></div></div><div class="menu-sm-buttons"><a href="../solutions" class="menu-md-other-button w-button">Solutions</a><link rel="prefetch" href="../solutions"/><a href="../pricing" class="menu-md-other-button w-button">Pricing</a><a href="http://0x.org/docs" target="_blank" class="menu-md-other-button w-inline-block"><div>Docs</div><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/640febc93f4bfba547eaf378_icon-arrow-up-right-800.svg" loading="lazy" height="" alt="" class="image-13"/></a><a href="../content-hub" class="menu-md-other-button w-button">Content hub</a><a href="../contact" class="menu-md-other-button w-button">Contact us</a></div></div><div class="div-block-23"><a href="https://dashboard.0x.org" target="_blank" class="button-normal button-round button-menu-sm w-button">Go to dashboard</a></div></div><div class="menu-md"><div class="menu-md-product-button-container"><a href="../products/swap" class="menu-md-product-button w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap.webp" loading="lazy" alt="Swap API" sizes="100vw, 129px" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb5d8c7de7124edddbf_swap.webp 1000w" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><p class="body-m-median mb-0">Swap</p><p class="body-m-median mb-0 text-gray-400"> API</p></div><p class="text-gray-400 body-s mb-0">Enable crypto trading</p></div></a><a href="../products/tx-relay" class="menu-md-product-button w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay.webp" loading="lazy" alt="Tx Relay API" sizes="100vw, 129px" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb57b2cc6cf1a426e0c_tx-relay.webp 1000w" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><p class="body-m-median mb-0">Tx Relay</p><p class="body-m-median mb-0 text-gray-400"> API</p></div><p class="text-gray-400 body-s mb-0">Build frictionless apps</p></div></a><div class="menu-md-product-button bg-white inactive"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb494b6431b4627b653_orderbook.webp 1000w" alt="Ordebook API" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><h6 class="mb-0 text-gray-800 body-m-median">Orderbook</h6><h6 class="mb-0 text-gray-400 body-m-median"> API</h6></div><p class="mb-0 mt-0 body-s">Unlock limit orders</p></div></div><div class="menu-md-product-button bg-white inactive"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb403c901ff764d592a_tx-history.webp 1000w" alt="Tx History API" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><h6 class="mb-0 text-gray-800 body-m-median">Tx History</h6><h6 class="mb-0 text-gray-400 body-m-median"> API</h6></div><p class="mb-0 mt-0 body-s">Show order history</p></div></div><div class="menu-md-product-button bg-white inactive"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry.webp" loading="lazy" sizes="100vw" srcset="https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry-p-500.webp 500w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry-p-800.webp 800w, https://assets.website-files.com/640bf70a17d12b42d97a052b/6440ceb4508190612d79f6f0_token-registry.webp 1000w" alt="Token Registry API" class="menu-md-product-button-image"/><div class="menu-md-product-button-text"><div class="menu-md-product-button-heading"><h6 class="mb-0 text-gray-800 body-m-median">Token Registry</h6><h6 class="mb-0 text-gray-400 body-m-median"> API</h6></div><p class="mb-0 mt-0 body-s">Boots tokens</p></div></div></div><div class="menu-md-other-buttons"><a href="../solutions" class="menu-md-other-button w-button">Solutions</a><a href="../pricing" class="menu-md-other-button w-button">Pricing</a><a href="http://0x.org/docs" target="_blank" class="menu-md-other-button w-inline-block"><div>Docs</div><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/640febc93f4bfba547eaf378_icon-arrow-up-right-800.svg" loading="lazy" height="" alt="" class="image-13"/></a><a href="../content-hub" class="menu-md-other-button w-button">Content hub</a><a href="../contact" class="menu-md-other-button w-button">Contact sales</a></div></div></div></nav><div class="section w-container"><div class="main-narrow"><div class="header-blog"><h3>Scaling DeFi — Layer One</h3><p>A visual tour of Ethereum’s scaling challenge.</p><div class="body-m">Published on</div><div class="body-m gray-400">September 1, 2021</div><div class="header-blog-category-wrapper"><div style="color:#421400;background-color:#ffe7bd" class="body-sm-median blog-tag">Insights</div></div></div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/643f1e0c42eb6132fb7243fa_154.png" loading="lazy" alt="Scaling DeFi — Layer One" sizes="(max-width: 479px) 93vw, (max-width: 767px) 94vw, 720px" srcset="https://assets.website-files.com/641b3189771d28b3a1d81347/643f1e0c42eb6132fb7243fa_154-p-500.png 500w, https://assets.website-files.com/641b3189771d28b3a1d81347/643f1e0c42eb6132fb7243fa_154-p-800.png 800w, https://assets.website-files.com/641b3189771d28b3a1d81347/643f1e0c42eb6132fb7243fa_154-p-1080.png 1080w, https://assets.website-files.com/641b3189771d28b3a1d81347/643f1e0c42eb6132fb7243fa_154.png 1920w" class="blog-post-main-image"/><div class="w-richtext"><p>If you have used DeFi recently, you have experienced sticker shock from transaction fees. It is pretty normal nowadays to pay tens to hundreds of dollars in fees for an Ethereum transaction. At these prices only whales can trade profitably and you can forget about lofty goals like banking-the-unbanked or permissionless financial infrastructure for everyone. Ethereum is becoming a place for the rich.</p><figure class="w-richtext-figure-type- w-richtext-align-fullwidth" style="max-width:375pxpx" class="w-richtext-align-fullwidth"><div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/641debd92226585df3657a63_1-H_T5p0_OSTFA81l9oR2mA.png" alt=""/></div><figcaption><em>Small trades can end up paying more than 10% in fees.</em></figcaption></figure><p>The high fees are only a symptom of the larger <em>blockchain scalability problem</em>, a problem so notorious it has it’s <a href="https://en.wikipedia.org/wiki/Bitcoin_scalability_problem">own Wikipedia page</a>. It is the biggest limitation of current blockchains, but there are more limitations such as long finality times, susceptibility to front-running, cross-chain interoperability, etc.</p><p>We want to <em>create a tokenized world where all value can flow freely</em> and blockchain limitations are not helping our mission. This is why 0x Labs has a team of research engineers developing solutions to tackle those limitations. In this post, we will explore what Ethereum’s limits look like and how it affects you, the DeFi user. We will also briefly cover next-generation blockchains. In follow up posts we will explore a different class of solutions, <em>layer two</em>, and present our own strategy to serve the needs of DeFi.</p><p>To start, remember that Ethereum transactions have different sizes measured in <em>gas</em>. Transactions are collected in <em>blocks</em> which are created about every 13 seconds. Each block has room for a limited amount of transactions, known as the <em>gas limit</em>. Right now, each block has room for about 12 million gas worth of transactions. A plain ERC-20 token transfer takes about fifty thousand gas. This means blocks can contain at most 240 token transfers, or about 18 transactions per second. DeFi transactions often involve multiple token transfers and other bookkeeping which multiplies the cost and further limits the throughput. The gas limit and block time mean there is a constant supply of gas available for transactions.</p><p><em>Let’s start by looking at how the gas supply and its usage have grown over Ethereum’s history.</em></p><h3>Gas Usage</h3><p>Each day about six thousand blocks are mined, creating room for a few billion gas worth of transactions. This amount has been changing and growing over time, mostly due to increases in the gas limit. Meanwhile, the total gas consumed by transactions has also been growing as Ethereum get more and larger transactions.</p><p>Looking back at the entire history of Ethereum the supply (gray) and consumption (black) of gas looks like this:</p><figure class="w-richtext-figure-type- w-richtext-align-fullwidth" style="max-width:1245pxpx" class="w-richtext-align-fullwidth"><div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/641debd92226580e6a657a6a_1GvVs7L3Cpm2LaoOagepKuQ.png" alt=""/></div></figure><figure class="w-richtext-figure-type- w-richtext-align-fullwidth" style="max-width:1209pxpx" class="w-richtext-align-fullwidth"><div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/641debd922265888bb657a68_1oee6CZJkE2_QK9aHZu5-aA.png" alt=""/></div><figcaption><em>(You can tell Ethereum is enterprise grade because usage is higher on office days)</em></figcaption></figure><p>Right before the <a href="https://eips.ethereum.org/EIPS/eip-609">Byzantium</a>, <a href="https://eips.ethereum.org/EIPS/eip-1013">Constantinople</a> and <a href="https://eips.ethereum.org/EIPS/eip-2387">Muir Glacier</a> hardforks, there are jagged crashes in the gas supply. These are the effects of Ethereum’s <em>Difficulty Bomb</em>, also known as <em>Ice Age</em>. During an Ice Age, the block time increases exponentially causing fewer blocks to be mined in a day and thus a lower total daily gas supply. This is of course very undesirable and forces the network to adopt a hardfork to fix it. And that’s exactly what it is for: it prevents innovation stagnation by forcing hard forks which bring many improvements. The <a href="https://eips.ethereum.org/EIPS/eip-1679">Istanbul</a> hardfork forgot to reset the bomb, so was quickly followed by Muir Glacier. The upcoming <a href="https://eips.ethereum.org/EIPS/eip-2070">Berlin</a> hardfork is considering changing this mechanism (EIP <a href="https://eips.ethereum.org/EIPS/eip-2515">2515</a>).</p><p>Looking at the usage (in black) Ethereum has been running above 60% capacity since the ICO craze started in 2017. Since then the gas limit has increased fourfold in distinct jumps, each time followed by a commensurate increase in gas usage. For the last few months, Ethereum seems stuck at 95% usage.</p><p><em>To understand why Ethereum can’t go over 95% usage, we need to look at empty and ommer blocks.</em></p><h3>Empty and Ommer blocks</h3><p>Throughout its history, Ethereum never uses more than about 95% of the limit despite demand being there. Surprisingly this remaining 5% is wasted in blocks that are completely empty. These empty blocks happen regularly, about once every twenty blocks. Why would someone mine empty blocks when there are transactions that will pay for inclusion? Let’s look at the data:</p><figure class="w-richtext-figure-type- w-richtext-align-fullwidth" style="max-width:1240pxpx" class="w-richtext-align-fullwidth"><div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/641debd9222658aa7b657a66_178uKuFpqnZbBKYtoeftZUA.png" alt=""/></div></figure><p>The rate of empty blocks is steadily increasing over time, and currently at about 5%. All the mining pools contribute to it equally, so it’s not a malicious miner. Instead, the real causes seem to be fast blocks. If the time to mine a block was less than 6 seconds, the chances of it being empty go up exponentially.</p><p>One explanation is that miners start mining the next block the moment they receive a new block header, but before they have processed the whole block. This trick, known as <a href="https://blog.bitmex.com/empty-block-data-by-mining-pool/">SPV mining</a> in Bitcoin, helps miners get started on the next block immediately, but it can only produce empty blocks. Once the new block is fully processed, the miner can assemble the next full block and switch to mining that one. Further evidence for this explanation is the empty block rate reduces by 25% if the same miner finds two blocks in quick succession.</p><p>The alternative to mining empty blocks is to keep mining on the previous block while you are processing the new one. This can cause multiple next blocks to be mined. If this happens Ethereum will pick a canonical block and remember the others as <a href="https://english.stackexchange.com/a/182426">ommers</a>. Miners still get a small reward for the ommers. This happens at a steady rate:</p><figure class="w-richtext-figure-type- w-richtext-align-fullwidth" style="max-width:1263pxpx" class="w-richtext-align-fullwidth"><div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/641debd92226580042657a65_1l5egipqODGtSiW7J-9cUrw.png" alt=""/></div></figure><p>The ommer rate peaked during the 2018 usage spike but has been decreasing to a stable rate of 5% of all blocks mined. This coincides with the increase in the empty block rate as miners likely switched strategies around this time.</p><p>It is not immediately obvious that the ommer rate hurts Ethereum scaling but it does. Since <a href="https://eips.ethereum.org/EIPS/eip-100">EIP-100</a> in Byzantium the difficulty adjustment maintains a constant rate of canonical <em>and</em> ommer blocks. So a high ommer rate means more blocks are wasted on ommers and fewer grow the chain. This shows up as an increase in block times and thus less total gas available per day. (The other major cause for increased block times being ice ages.)</p><p>Whether it’s ommers or empty blocks, these are important network health signals for Ethereum. An increase in either means that less daily total gas is available for transactions. Analysis of the ommer rate is the big part of the research backing EIPs <a href="https://eips.ethereum.org/EIPS/eip-2028">2028</a> and <a href="https://eips.ethereum.org/EIPS/eip-1559">1559</a> (see <a href="https://ethereum-magicians.org/t/eip-2028-transaction-data-gas-cost-reduction/3280/24">1</a>, <a href="https://ethereum-magicians.org/t/eip-2028-transaction-data-gas-cost-reduction/3280/35">2</a>, <a href="https://github.com/ethereum/research/raw/master/papers/pricing/ethpricing.pdf">3</a>). It is surprising though that neither mentions the empty block rate and that the research has methodological <a href="https://ethereum-magicians.org/t/eip-2028-transaction-data-gas-cost-reduction/3280/36">flaws</a>. It would be preferable to have a more rigourous analysis considering both ommer and empty rate using appropriate statistical methods like logistic regression.</p><p>There are ways to lower the ommer and empty rate. The presumed root cause is mining pools not having the latest state available due to network and processing delays. One simple but undesirable solution is to centralizing mining pools more so that latest state is in one place. Slightly more decentralized solutions like <a href="https://medium.com/bloxroute/ethereum-miner-test-results-8fbee68b7088">bloxroute</a> are creating dedicated interconnects between pools. An idea inspired by ‘spy mining’ would be for pools to pre-share the block that they are currently trying to mine. Other pools would prepare next blocks for each eventuality and once a pool successfully mines its block, they already know which block they want to mine on next and can switch in an instant. Going higher up the stack, improvements in node communication protocols and processing algorithms would help too, there is likely still some room for gains here. But in the end, lowering the ommer and empty rate by itself will improve the daily gas supply by at most about the 5% we saw.</p><p><em>So it seems there is a 95% gas limit, but what happens if people want to use more than the 95%?</em></p><h3>Gas Prices</h3><p>What happens when Ethereum gets close to the gas limit? Miners are free to select transactions as they desire (more about that later), but in practice they process them in order of highest-gas price-first as this (approximately) maximizes their profit. The net effect is a first price auction on the available gas.</p><figure class="w-richtext-figure-type- w-richtext-align-fullwidth" style="max-width:1142pxpx" class="w-richtext-align-fullwidth"><div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/641debd9222658878b657a69_1XWpctGddcoZwThogrFWRjQ.png" alt=""/></div><figcaption><em>(</em><a href="https://www.redbubble.com/shop/ap/51175945"><em>Prints available</em></a><em>)</em></figcaption></figure><p>The gas price has become a textbook example of <em>perfectly inelastic supply</em>. It starts to noticeably increase as the network goes beyond 80% utilization and takes off vertically at the 95% mark. Any potential further growth in demand will only increase the prices until demand is discouraged back to the same level. The only way for prices to go down is to raise the gas supply or decrease the demand and the recent increase in gas limit was not enough to meaningfully lower gas prices.</p><p>At first glance, any further interest in Ethereum will just raise the prices and not lead to more usage. In reality the lower value usage will be crowded out by higher value usage, there will be fewer trades of cheap game NFTs and more large DeFi trades.</p><p>Proposal EIP <a href="https://eips.ethereum.org/EIPS/eip-1559">1559</a> aims to make the gas supply more elastic on short timescales. During periods of high demand larger blocks can be created (up to 20 million gas). This should help smooth out the peaks in gas price and let transactions be included sooner. What it won’t do however is change the long term supply inelasticity. Under EIP-1559 there will still be a long term fixed rate of gas, meaning the price will go up until demand is small enough. Under EIP-1559 there is still an incentive to pay a premium for being processed first within a block (assuming pools continue to author blocks in that order). This means front-running, gas-bidding-wars and miner extraction of value will continue to be a thing.</p><p>The numbers in the graph represent the minimal price to be included in the next block. If you are willing to wait longer the gas prices can be much lower. Historical data suggest a decent drop-off if you are willing to wait two minutes or longer. EIP-1559 should help to reduce the premium for faster processing.</p><p><em>So gas prices go up when we hit the gas limit, how do we raise this limit?</em></p><h3>Gas Limit</h3><p>The mining pools decide the gas limit. Let’s quickly recap how miners and pools work: Nearly all miners pool their resources. Instead of all trying to find the next block and risk going for long times without any payout, they pool their resources and get a steady income stream. This is facilitated by <em>mining pools</em> that verify each miners contributions and author the next block to work on. The larger pools end up authoring a large fraction of all the blocks. Let’s look at how these shares developed in Ethereum’s history:</p><figure class="w-richtext-figure-type- w-richtext-align-fullwidth" style="max-width:1257pxpx" class="w-richtext-align-fullwidth"><div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/641debd9222658b7a2657a6b_1sofjBq4zRhKgM6eQQn3ZsA.png" alt=""/></div></figure><p>Sparkpool, Ethermine and F2Pool together authored the majority of the blocks.</p><p>Besides participating in hard forks, pool operators have one important governance responsibility: they set Ethereum’s gas limit. Unlike block time and gas price (which are emergent properties) the gas limit is actively decided on for each block. The new gas limit is constraint to be within 0.1% from the previous blocks, so each block can only make a small nudge up or down (<a href="https://ethereum.github.io/yellowpaper/paper.pdf">yellow paper</a> eq. 47). If they all agree the nudges quickly compound so that in 2.5 hours the gas limit can double or halve. If there is no agreement the gas limit becomes the median weighted by pool size.</p><blockquote><em>Currently , due to a lack of clear information about how miners will behave in reality, we are going with a fairly simple approach: a voting system. […] The hope is that in the future we will be able to soft-fork this into a more precise algorithm. — </em><a href="https://eth.wiki/en/fundamentals/design-rationale#gas-and-fees"><em>Ethereum Design rationale</em></a><em> (first added </em><a href="https://github.com/ethereum/wiki/wiki/Design-Rationale/82606c7ab81f6dbe346bf438b057859f62676a98"><em>2015–03</em></a><em>)</em></blockquote><p>The way miners set the gas limit is a stop-gap solution from the early days of Ethereum. As with many stop-gap solutions that are <a href="https://en.wikipedia.org/wiki/Worse_is_better">good enough</a>, the stop-gap became semi-permanent. EIP <a href="https://eips.ethereum.org/EIPS/eip-1559">1559</a> proposes a different mechanism and is currently discussed for the Berlin hardfork. Until then, the pool operator can govern the gas supply much like OPEC governs oil production:</p><blockquote>The <a href="https://twitter.com/hashtag/Ethereum?src=hash&amp;ref_src=twsrc%5Etfw">#Ethereum</a> miners are voting to increase the Block Gas Limit from 10,000,000 to 12,500,000. ⛏️<br/><br/>In theory, this means that the Ethereum network now has the capabilities to handle ~44 transactions per second, instead of ~35. <br/><br/>Another huge milestone for the community.🥳🎉 — Bitfly (@etherchain_org) <a href="https://twitter.com/etherchain_org/status/1273912037274537984?ref_src=twsrc%5Etfw">June 19, 2020</a></blockquote><p>Recently the two largest mining pools made the somewhat controversial decision to raise the daily gas production by 25%. The goal is to provide much needed relief from the high transaction fees by increasing the gas supply. From what we seen so far the demand for transactions grows faster than the gas limit can be increased, which means prices might get temporary relief, but will eventually go up again.</p><blockquote>TL;DR: The <a href="https://twitter.com/hashtag/Ethereum?src=hash&amp;ref_src=twsrc%5Etfw">#Ethereum</a> miners don&#x27;t give a fuck about the long term health of the network nor about DoS attacks. — Péter Szilágyi (karalabe.eth) (@peter_szilagyi) <a href="https://twitter.com/peter_szilagyi/status/1273921434700730369?ref_src=twsrc%5Etfw">June 19, 2020</a></blockquote><p>Raising the gas limit comes with a big hidden cost on Ethereum’s security. As we have seen, the gas limit can increase the ommer and empty block rate. This increase is small under normal transaction load. But for security we are not interested in normal behavior, only in worst-case adversarial behavior. <a href="https://arxiv.org/abs/1909.07220">Perez &amp; Livshits (2019)</a> study this worse case and generated transactions that are 100 times slower to process than normal ones for the same gas cost. If you fill a block with such transactions it would take a node 90 seconds to process it, causing nodes to fall behind and pools to miner ommers and empty blocks. Since publication, there have been some mitigations, but it is far from solved. This caused two leading node developers <a href="https://twitter.com/peter_szilagyi/status/1273921434700730369">Péter Szilágyi</a> and <a href="https://twitter.com/realLedgerwatch/status/1273949773062701056">Alexey Akhunov</a> to criticize the decision to raise the gas limit.</p><p><em>So gas prices go up when we hit the gas limit, and it looks like we shouldn’t increase the gas limit much further. What else can we do? Can we maybe lower the gas cost of transactions?</em></p><h3>Gas Cost</h3><p>The gas cost of a transaction is made up mostly by the cost EVM operations. Transactions are made up of many EVM operations and the cost of each operation is governed through EIPs and hard forks. In past hardforks, the gas cost of certain operations have been increased (EIPs <a href="https://eips.ethereum.org/EIPS/eip-150">150</a>, <a href="https://eips.ethereum.org/EIPS/eip-160">160</a>, <a href="https://eips.ethereum.org/EIPS/eip-1884">1884</a>) or decreased (EIPs <a href="https://eips.ethereum.org/EIPS/eip-1108">1108</a>, <a href="https://eips.ethereum.org/EIPS/eip-2028">2028</a>, <a href="https://eips.ethereum.org/EIPS/eip-2200">2200</a>). The planned <a href="https://eips.ethereum.org/EIPS/eip-2070">Berlin hardfork</a> also considers a number of gas specific changes (EIPs <a href="https://eips.ethereum.org/EIPS/eip-1380">1380</a>, <a href="https://eips.ethereum.org/EIPS/eip-1559">1559</a>, <a href="https://eips.ethereum.org/EIPS/eip-2046">2046</a>, <a href="https://eips.ethereum.org/EIPS/eip-2565">2565</a>, <a href="https://eips.ethereum.org/EIPS/eip-2537">2537</a>).</p><p>The goal of all these changes is to make the fees more accurately reflect the true cost of the operations. This means the cost of computing operations will go down as computers and algorithms become faster. The cost of storage operations is a different story. The cost of storage and lookups depends and the size of the chain state, and the size of Ethereum’s state <a href="https://etherscan.io/chartsync/chaindefault">keeps growing</a>. This growth is not offset by improvements in storage devices or databases.</p><p>This means storage will continue to be a big cost in DeFi. Creating a new balance costs 20 thousand gas and modifying an existing one 5 thousand. A transfer modifies at least two balances, an exchange at least four and more complex DeFi transactions can involve many more costly pieces of state. There seems to be no easy way to reduce the amount of storage involved and the cost of it is looking to go up if anything. On the bright side layer two scaling solutions, which tend to be storage light and compute-heavy, will look more favorable.</p><p>Finally, the same security concerns apply as with raising the gas limit: it’s the worst-case that matters. Naively optimizing the gas cost for the current true average cost of operations is very dangerous.</p><p><em>By now it is clear why scaling Ethereum is such a thorny problem. Before we talk about proposed solutions, we want to digress into one more limitation of current Ethereum that hurts DeFi users.</em></p><h3>Miner extractable value</h3><p>Block authors are bound by the consensus rules which provide some important freedoms such as transaction selection and ordering. For regular token transfers, this does not matter much, but for DeFi transactions like exchange trades there is significant economic value in front-running trades. More complicated exploits can be considered where a target transaction is sandwiched between two attacking ones. <a href="https://arxiv.org/pdf/1904.05234">Daian et al. (2019)</a> call this <em>miner extractable value</em>.</p><p>It does not appear that pools are maliciously using their transaction-ordering freedom, but they still benefit from it as if they did. Pools likely use Geth which orders transactions by gas price (see <a href="https://github.com/ethereum/go-ethereum/blob/v1.9.19/miner/worker.go#L961">1</a>, <a href="https://github.com/ethereum/go-ethereum/blob/v1.9.19/core/types/transaction.go#L346">2</a>). This creates a gas-price auction, the highest paying transaction goes in first. This has the unfortunate effect that anyone can front-run a trade by bidding higher. Competitive traders keep bidding the gas price up until the trade profit is entirely consumed by the gas fee. At this point, all the exploitable value ends up as transaction fees in the miners’ pockets.</p><p>In other situations, there is value in being right after another transaction, for example to be the first to liquidate a position after a price oracle update. This is called <a href="https://github.com/ethereum/go-ethereum/issues/21350">back-running</a> and also ends up profiting the miners.</p><p>The miner extractable value is ultimately extracted from regular DeFi users through bigger spreads, worse prices, higher fees and more failed transactions. For a great DeFi experience this should be addressed. The way to solve it is by restricting the transaction ordering freedom, for example by requiring transactions in a block to be ordered lowest-gas-price first.</p><p><em>Ok, so now we have a good overview of Ethereum’s limitations and how they affect DeFi. Surely all the rock-star teams working on scaling are going to solve it, right?</em></p><h3>Layer One, Version Two</h3><p>There are many very impressive teams working on different solutions to the scaling problem. The solutions come in two flavors, <em>layer one</em> and <em>layer two</em>. Layer one solutions aim to build a more scalable alternative to Ethereum, layer two solutions build more scalable infrastructure on top of Ethereum. Let’s start with layer one and leave layer two for the next post.</p><p>Let’s start with the obvious: improving the performance of existing Ethereum. This is essential what the <em>Eth1x</em> effort is doing. By improving the performance of Ethereum clients there is still a lot that can be done. Unfortunately, Eth1x doesn’t get nearly the support it deserves, so progress is slow. To get an idea of the performance that can be achieved this way we only have to look at <a href="https://solana.com/">Solana</a>, which achieves over a thousand times the throughput of Ethereum with room to grow. The main downside of this approach is that it requires sophisticated hardware to run a full node.</p><p>Most of the other solutions have three things in common: the use of <a href="https://webassembly.org/">WebAssembly</a> as the virtual machine, architectures with minimal state, and most importantly, <em>sharding</em>. Current Ethereum executes all transactions in <a href="https://jepsen.io/consistency/models/serializable">sequence</a>. In fact, putting transactions in a sequence is arguably the whole point of a blockchain. The downside of this model is that it is hard to do in parallel, so we can not solve scaling easily by throwing more resources at it. This is where <em>next-generation</em> blockchains like Eth2.0 come in. By changing the way transactions are executed so they can be handled in parallel. This is done by splitting the blockchain into multiple loosely connected domains, a process called <a href="https://en.wikipedia.org/wiki/Shard_(database_architecture)">sharding</a>. Within a shard, things can still happen sequentially but between shard they occur <em>asynchronously</em>. This allows all shard to run in parallel, scaling the network by roughly the number of shards. The domains we use for splitting also don’t have to correspond with shards, we can have multiple domains assigned to the same shard, or even move them around to get load balancing. See Near protocol’s <a href="https://near.org/papers/nightshade">Nighshade paper</a> for a more in-depth overview of sharding.</p><p>Exactly where and how the chain is split into domains depends on the particular next-generation chain. They can be thought of on a spectrum from fine-grained (many tiny domains) to coarse grained (few large domains).</p><p>fine parallelization  &lt;-------------------&gt; coarse parallelization<br/><br/>      DFinity               Eth 2.0              Polkadot<br/>       actors          (TBD. Contracts?)          chains</p><p>Two projects conveniently span the spectrum of granularity. DFinity is on the fine-grained end, where each <a href="https://sdk.dfinity.org/docs/language-guide/actors-async.html">actor</a> is its own little domain and every actor interaction is asynchronous. A bit less fine-grained is Near protocol where each contract is its own domain. On the coarse-grained end is PolkaDot, where the domain is an entire shard, in this context more accurately called a <a href="https://wiki.polkadot.network/docs/en/learn-parachains">parachain</a>. It’s too early to tell where <a href="https://hackmd.io/UzysWse1Th240HELswKqVA">Ethereum 2.0</a> will land from a Dapp developer perspective. The Eth1EE (the post-Eth2 future of Eth1) will be coarse and have the boundaries coincident with shards with current Ethereum becoming a single shard. A dedicated Eth2EE may go for a more fine-grained solution. The advantage of fine-grained solutions is that they are transparent; they can make all inter-contract calls look the same, whether they cross shard boundaries or not. This in turn allows easy load balancing by moving contracts between shards.</p><p>The downside is that domain-crossing transactions are no longer atomic, instead they become <em>concurrent</em> and partially <em>irreversible</em>. In DFinity and Near this shows up as inter-contract calls being async and returning a promise that you need to await. During an await, all that has happened so far will get committed to the chain. And then other people&#x27;s transactions can get piled on top of it. At this point you can not revert what has happened so far. When the await finally resolves it can return success or failure from the contract call. There are various proposals to avoid this and get some form of atomicity back across shards, but they have their own downsides. Embracing the non-atomicity looks like the natural outcome.</p><p>For DeFi an asynchronous transferFrom call poses quite a challenge. Imagine a simple exchange between two parties, Alice and Bob want to exchange Eth for Dai. The basic contract would look like</p><figure class="w-richtext-figure-type- w-richtext-align-fullwidth" style="max-width:895pxpx" class="w-richtext-align-fullwidth"><div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/641debd9222658b848657a67_1g81oX0b00bEMtDa4QpD6dQ.png" alt=""/></div></figure><p>but now we need to handle the errors. If the first transaction fails, we can simply stop the transactions. But if the second transaction fails, we need to give Alice back the 1 Eth. The problem is, Bob may have already spend it by the time we get there. One way to solve this is using an escrow</p><figure class="w-richtext-figure-type- w-richtext-align-fullwidth" style="max-width:903pxpx" class="w-richtext-align-fullwidth"><div><img src="https://assets.website-files.com/641b3189771d28b3a1d81347/641debd92226583dee657a64_1nTKF6QKLcV155TgC2x15gw.png" alt=""/></div></figure><p>Good, no-one is losing tokens anymore. But now Bob has a free exclusive option on Alice’s offer. While Alice’s tokens are being held in escrow they are not available for other trades and it is not yet guaranteed that the transaction with Bob will succeed. You could solve this by penalizing bad behavior, but it is hard to determine appropriate penalties as DeFi transactions can be very valuable. You could also solve it by requiring all market participants to have their funds in escrow from the beginning in a single deposit contract, but this centralizes state again and essentially undoes the sharding.</p><p>The other thing to note is how tricky these concurrency issues can be. In a real exchange, there is also the fill-state of the order that needs to be updated, which further complicates the protocol. The reentrancy bugs that have plagued Ethereum 1.0 are just butterflies compared to the bed bug infestation that is concurrency bugs. Concurrency bugs are non-deterministic and never seem to happen during testing. As we saw in the simple exchange, they require rethinking the architecture from the ground up because like bed bugs, the only reliable way to get rid of them is to tear everything down and rebuild it from the ground up.</p><p>Exchange is a foundation that the rest of DeFi builds on, and it is a notoriously serial process. We’ve seen how orderbook based exchanges pose a challenge. Automated market maker exchanges are simpler because they already have reserve funds in escrow, but in there the reserve balances themselves form the bottleneck preventing parallelization. Even in the fastest traditional exchanges, the settlements are ultimately serialized on a single matching engine without concurrency (though hopefully with <a href="https://en.wikipedia.org/wiki/Redundancy_(engineering)">redundancy</a>), for a deep dive on how traditional exchange works, <a href="https://www.youtube.com/watch?v=b1e4t2k2KJY">Brian Nigito’s talk</a> is excellent.</p><p>That doesn’t mean these problems are impossible to solve. The simplest solution would be for all these protocols to deploy independent instances on each shard and have arbitrageurs keep them in sync. Or maybe we can get a single synchronous shard to be performant enough to contain all of DeFi and we can stop worrying about concurrency.</p><h3>References</h3><ul role="list"><li><a href="https://arxiv.org/abs/1909.07220">Daniel Perez &amp; Benjamin Livshits (2019). “Broken Metre: Attacking Resource Metering in EVM.”</a></li><li><a href="https://arxiv.org/abs/1904.05234">Daian et al. (2019). “Flash Boys 2.0: Frontrunning, Transaction Reordering, and Consensus Instability in Decentralized Exchanges.”</a></li><li><a href="https://www.youtube.com/watch?v=b1e4t2k2KJY">Brian Nigito (2017). “How to Build an Exchange.”</a></li><li><a href="https://blog.ethereum.org/2020/06/02/the-state-of-eth2-june-2020/">Danny Ryan (2020). “The State of Eth2, June 2020.”</a></li><li><a href="https://hackmd.io/UzysWse1Th240HELswKqVA?view">Scott Shapiro &amp; William Villanueva (2020). “ETH 2 Phase 2 WIKI.”</a></li><li><a href="https://near.org/papers/nightshade/">Near Protocol sharding design</a></li></ul></div></div><div class="footer"><div class="footer-links"><div class="footer-0x-tag"><div class="footer-logo-container"><a href="../index.html" class="w-inline-block"><img src="https://assets.website-files.com/640bf70a17d12b42d97a052b/640bfd7d8441821c4cd20210_logo.svg" loading="lazy" alt="0x Logo wordmark, a bold &quot;zero&quot; and &quot;ex&quot;" class="image-11"/></a></div><p>Connecting developers to Web3 markets.</p></div><div class="footer-links grid"><div class="footer-link-card"><div class="footer-link-header">Product</div><ul role="list" class="footer-link-list w-list-unstyled"><li class="footer-link-item"><a href="../products/swap" class="footer-link">Swap API</a></li><li class="footer-link-item"><a href="../products/tx-relay" class="footer-link">Tx Relay API</a></li><li class="footer-link-item"><a href="../solutions" class="footer-link">Solutions</a></li></ul></div><div class="footer-link-card"><div class="footer-link-header">DEVELOPERS</div><ul role="list" class="footer-link-list w-list-unstyled"><li class="footer-link-item"><a href="http://0x.org/docs" target="_blank" class="footer-link">Documentation ↗</a></li><li class="footer-link-item"><a href="https://ethereum.stackexchange.com/questions/tagged/0x" target="_blank" class="footer-link">Stack Exchange ↗</a></li><li class="footer-link-item"><a href="../contact" class="footer-link">Contact Us</a></li></ul></div><div class="footer-link-card"><div class="footer-link-header">Company</div><ul role="list" class="footer-link-list w-list-unstyled"><li class="footer-link-item"><a href="../legal/terms-of-service" class="footer-link">Terms of Service</a></li><li class="footer-link-item"><a href="../legal/privacy-notice" class="footer-link">Privacy Notice</a></li><li class="footer-link-item"><a href="../legal/cookie-notice" class="footer-link">Cookie Notice</a></li><li class="footer-link-item"><a href="../legal/api-license-agreement" class="footer-link">API License Agreement</a></li><li class="footer-link-item"><a href="../careers" class="footer-link">Careers</a></li><li class="footer-link-item"><a href="../press" class="footer-link">Press</a></li><li class="footer-link-item"><a href="../media-kit" class="footer-link">Media Kit</a></li></ul></div></div></div><div class="divider"></div><div class="footer-bottom"><p>© ZeroEx Holdings, Inc. All rights reserved.</p><div class="footer-socials"><a href="https://twitter.com/0xproject" target="_blank" class="w-inline-block"><div class="html-embed socials-hover w-embed"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M0 14C0 6.28043 6.28043 0 14 0C21.7201 0 28 6.28043 28 14C28 21.719 21.719 28 14 28C6.28043 28 0 21.719 0 14ZM20.3694 10.7313C20.3758 10.8728 20.3792 11.0155 20.3792 11.1581C20.3792 15.5013 17.0743 20.5076 11.0274 20.5076C9.17134 20.5076 7.44351 19.9652 5.98946 19.0323C6.24656 19.0627 6.50827 19.0783 6.77343 19.0783C8.31375 19.0783 9.73041 18.5526 10.8555 17.6714C9.41751 17.6449 8.20331 16.6947 7.78516 15.3885C7.98532 15.4265 8.19181 15.4478 8.4029 15.4478C8.70257 15.4478 8.99361 15.4087 9.26912 15.3333C7.7656 15.0319 6.63308 13.7038 6.63308 12.1106C6.63308 12.0968 6.63308 12.0824 6.63366 12.0692C7.07654 12.3148 7.58327 12.4632 8.12164 12.4799C7.24047 11.8914 6.66012 10.8849 6.66012 9.74489C6.66012 9.14211 6.82174 8.57728 7.10473 8.09183C8.725 10.0808 11.1476 11.3887 13.8786 11.5268C13.8222 11.2858 13.794 11.0356 13.794 10.7773C13.794 8.96265 15.2653 7.49077 17.08 7.49077C18.0256 7.49077 18.8786 7.88995 19.4791 8.52839C20.2285 8.38115 20.9302 8.10851 21.567 7.73062C21.3196 8.49848 20.8002 9.14211 20.1198 9.54933C20.7853 9.46996 21.4203 9.29395 22.0075 9.03225C21.5693 9.69025 21.0119 10.2694 20.3694 10.7313Z" fill="CurrentColor"/>
</svg></div></a><a href="https://www.reddit.com/r/0xProject/" target="_blank" class="w-inline-block"><div class="html-embed socials-hover w-embed"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10.7907 14C9.98831 14 9.33334 14.655 9.33334 15.4574C9.33334 16.2597 9.98831 16.9147 10.7907 16.9147C11.593 16.9147 12.248 16.2597 12.248 15.4574C12.248 14.655 11.593 14 10.7907 14Z" fill="CurrentColor"/>
<path d="M14.0164 20.3696C14.5731 20.3696 16.4725 20.3041 17.4714 19.3053C17.6187 19.1579 17.6187 18.9287 17.5041 18.765C17.3567 18.6176 17.1111 18.6176 16.9637 18.765C16.3252 19.3872 14.9988 19.6164 14.0328 19.6164C13.0667 19.6164 11.724 19.3872 11.1018 18.765C10.9544 18.6176 10.7088 18.6176 10.5614 18.765C10.414 18.9123 10.414 19.1579 10.5614 19.3053C11.5439 20.2878 13.4597 20.3696 14.0164 20.3696Z" fill="CurrentColor"/>
<path d="M15.7521 15.4574C15.7521 16.2597 16.407 16.9147 17.2094 16.9147C18.0117 16.9147 18.6667 16.2597 18.6667 15.4574C18.6667 14.655 18.0117 14 17.2094 14C16.407 14 15.7521 14.655 15.7521 15.4574Z" fill="CurrentColor"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M28 14C28 21.732 21.732 28 14 28C6.26801 28 0 21.732 0 14C0 6.26801 6.26801 0 14 0C21.732 0 28 6.26801 28 14ZM21.2866 11.9533C22.4164 11.9533 23.3333 12.8702 23.3333 14C23.3333 14.8351 22.8257 15.5556 22.1544 15.8831C22.1871 16.0796 22.2035 16.2761 22.2035 16.4889C22.2035 19.6328 18.5521 22.1708 14.0328 22.1708C9.51346 22.1708 5.86199 19.6328 5.86199 16.4889C5.86199 16.2761 5.87837 16.0632 5.91112 15.8667C5.19065 15.5392 4.69942 14.8351 4.69942 14C4.69942 12.8702 5.61638 11.9533 6.74621 11.9533C7.28656 11.9533 7.79416 12.1825 8.15439 12.5264C9.56258 11.4948 11.5111 10.8562 13.6889 10.7907L14.7205 5.91115C14.7532 5.81291 14.8023 5.73104 14.8842 5.68191C14.9661 5.63279 15.0643 5.61642 15.1626 5.63279L18.5521 6.35326C18.7813 5.86203 19.2725 5.53455 19.8456 5.53455C20.648 5.53455 21.3029 6.18952 21.3029 6.99186C21.3029 7.7942 20.648 8.44917 19.8456 8.44917C19.0597 8.44917 18.4211 7.82694 18.3883 7.05735L15.3591 6.41876L14.4257 10.7907C16.5544 10.8726 18.4866 11.5275 19.8784 12.5264C20.2386 12.1661 20.7298 11.9533 21.2866 11.9533Z" fill="CurrentColor"/>
</svg></div></a><a href="https://github.com/0xProject" target="_blank" class="w-inline-block"><div class="html-embed socials-hover w-embed"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_2371_94106)">
<path fill-rule="evenodd" clip-rule="evenodd" d="M14 0C6.2678 0 0 6.4259 0 14.3551C0 20.6964 4.011 26.0776 9.5746 27.975C10.2746 28.1069 10.5294 27.664 10.5294 27.2828C10.5294 26.9432 10.5182 26.0389 10.5112 24.8423C6.6164 25.7093 5.7946 22.9177 5.7946 22.9177C5.159 21.2582 4.2406 20.8168 4.2406 20.8168C2.9694 19.9283 4.3372 19.9455 4.3372 19.9455C5.7414 20.0458 6.4806 21.4244 6.4806 21.4244C7.7294 23.617 9.758 22.9836 10.5546 22.6168C10.6834 21.6896 11.0446 21.0576 11.445 20.6993C8.337 20.3367 5.068 19.1043 5.068 13.6042C5.068 12.0378 5.614 10.7552 6.5086 9.75206C6.3644 9.38949 5.8842 7.92919 6.6458 5.95442C6.6458 5.95442 7.8218 5.56749 10.4958 7.42475C11.6379 7.10591 12.8162 6.94351 14 6.94181C15.19 6.94754 16.387 7.10661 17.5056 7.42475C20.1782 5.56749 21.3514 5.95298 21.3514 5.95298C22.1158 7.92919 21.6342 9.38949 21.4914 9.75206C22.3874 10.7552 22.9306 12.0378 22.9306 13.6042C22.9306 19.1186 19.656 20.3324 16.5382 20.6878C17.0408 21.1307 17.4874 22.0063 17.4874 23.3462C17.4874 25.2636 17.4706 26.8128 17.4706 27.2828C17.4706 27.6669 17.7226 28.114 18.4338 27.9736C21.2216 27.0164 23.6451 25.1867 25.3617 22.7429C27.0783 20.2992 28.0012 17.365 28 14.3551C28 6.4259 21.7308 0 14 0Z" fill="CurrentColor"/>
</g>
<defs>
<clipPath id="clip0_2371_94106">
<rect width="28" height="28" fill="white"/>
</clipPath>
</defs>
</svg></div></a></div></div></div></div><script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=640bf70a17d12b42d97a052b" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="https://assets.website-files.com/640bf70a17d12b42d97a052b/js/0xwebsite.4035636fa.js" type="text/javascript"></script><!-- Tooltips --> 
<script type="text/javascript">
  var script = document.querySelector('#tippy-loader');
  script.addEventListener('load', function() {
    tippy('.tooltip', {
     theme: 'zeroex',
      maxWidth: 212,
    });
  });
</script></body></html>